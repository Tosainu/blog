<!DOCTYPE HTML><html lang="ja"><head><meta charset="utf-8"><meta content="Tosainu" name="author"><meta content="[Zynq UltraScale+ MPSoC](https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html) をはじめとする Xilinx の各種プラットフォーム上で、決められた用途の Linux ベ" name="description"><meta content="Hakyll" name="generator"><meta content="width=device-width, initial-scale=1" name="viewport"><meta property="twitter:card" content="summary"><meta property="twitter:site" content="myon___"><meta property="twitter:creator" content="myon___"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.myon.info/entry/2020/11/29/archlinux-arm-on-zu/index.html"><meta property="og:title" content="Ultra96 で Arch Linux ARM を動かす | Tosainu Lab"><meta property="og:description" content="[Zynq UltraScale+ MPSoC](https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html) をはじめとする Xilinx の各種プラットフォーム上で、決められた用途の Linux ベ"><meta property="og:site_name" content="Tosainu Lab"><meta property="og:image" content="https://blog.myon.info/entry/2020/11/29/archlinux-arm-on-zu/screenfetch.png"><title>Ultra96 で Arch Linux ARM を動かす | Tosainu Lab</title><link href="/vendor/normalize.css/normalize.css" rel="stylesheet"><link href="/stylesheets/style.css" rel="stylesheet"><link href="/stylesheets/highlight.css" rel="stylesheet"><link href="/vendor/fontawesome/style.css" rel="stylesheet"><link href="/vendor/katex/katex.min.css" rel="stylesheet"><link href="/feed.xml" title="Atom Feed" type="application/atom+xml" rel="alternate"><script async src="https://www.googletagmanager.com/gtag/js?id=G-X1CGBSMEQW"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-X1CGBSMEQW');</script></head><body><header class="site-header"><div class="container"><h1><a href="/" title="home">Tosainu Lab</a></h1></div></header><main class="post"><article><header class="post-header"><div class="container"><h1><a href="/entry/2020/11/29/archlinux-arm-on-zu/">Ultra96 で Arch Linux ARM を動かす</a></h1><ul class="post-meta"><li><svg class="svg-inline--fa fa-calendar" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="calendar" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z" fill="currentColor"></path></svg></li><li class="date">2020/11/29 00:48</li><li><svg class="svg-inline--fa fa-tags" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="tags" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z" fill="currentColor"></path></svg></li><li><ul class="tag-list"><li><a href="/entry/tags/arch-linux/"><span>Arch Linux</span></a></li></ul></li></ul></div></header><div class="container"><div class="post-contents"><p><a href="https://www.xilinx.com/products/silicon-devices/soc/zynq-ultrascale-mpsoc.html" target="_blank" rel="nofollow noopener">Zynq UltraScale+ MPSoC</a> をはじめとする Xilinx の各種プラットフォーム上で、決められた用途の Linux ベースなシステムを構築するなら公式で提供されている <a href="https://www.xilinx.com/products/design-tools/embedded-software/petalinux-sdk.html" target="_blank" rel="nofollow noopener">PetaLinux Tools</a> が便利です。以前取り上げた <a href="/entry/2019/05/15/ultra96-julia-set-explorer/">Ultra96 のアレ</a>でも使っています。一方で、動かした Linux 環境の上で雑な作業したいなどの用途では、構築後の拡張がしにくい PetaLinux Tools は微妙です。例えば Raspberry Pi 向けに提供される <a href="https://www.raspberrypi.org/software/" target="_blank" rel="nofollow noopener">Raspberry Pi OS</a> のような汎用の Linux ディストリビューションベースの環境が欲しくなります。</p>
<p>Ultra96 向けに提供される汎用の Linux ディストリビューションベースな環境として、例えば <a href="http://www.pynq.io/" target="_blank" rel="nofollow noopener">PYNQ</a> が Ubuntu ベースらしかったり、<a href="https://github.com/ikwzm/ZynqMP-FPGA-Linux" target="_blank" rel="nofollow noopener">ikwzm さんの Debian 10 イメージ</a> などが見つかります。ただ、自分としては普段使って慣れている <a href="https://www.archlinux.org/" target="_blank" rel="nofollow noopener">Arch Linux</a> 環境があるともっと嬉しいな… ということで、<a href="https://archlinuxarm.org/" target="_blank" rel="nofollow noopener">Arch Linux ARM</a> を動かしてみました。</p>
<p><img src="/entry/2020/11/29/archlinux-arm-on-zu/screenfetch.png" /></p>
<p>この記事では、前半でインストール方法の一例を、後半で関連するファイル類などをあげた GitHub リポジトリ <a href="https://github.com/Tosainu/zynqmp-arch" target="_blank" rel="nofollow noopener">Tosainu/zynqmp-arch</a> について紹介していきます。</p>
<!--more-->
<h2 id="インストール方法">インストール方法</h2>
<h3 id="準備">準備</h3>
<p>作業にあたって必要なツールなどは次の通りです。</p>
<ul>
<li>Linux 環境 (Arch Linux, Ubuntu, CentOS など)</li>
<li><a href="https://www.xilinx.com/products/design-tools/vitis.html" target="_blank" rel="nofollow noopener">Vitis 2020.1</a><a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
<li>ライブラリを静的リンクした QEMU の User space emulator</li>
<li><a href="https://github.com/archlinux/arch-install-scripts" target="_blank" rel="nofollow noopener">arch-install-scripts</a></li>
</ul>
<p>今回紹介するインストール方法には、Linux 環境がインストールされた PC が必要です。特に後半の作業は Arch Linux があると楽ですが、Vitis がサポートする Ubuntu や CentOS でも大丈夫だと思います。ちなみに自分は Arch Linux を使い、Vitis は <a href="https://wiki.archlinux.org/index.php/Systemd-nspawn" target="_blank" rel="nofollow noopener">systemd-nspawn</a> を使って構築した Ubuntu 環境内で動かしています<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>。</p>
<p><a href="https://www.xilinx.com/html_docs/xilinx2020_1/vitis_doc/upu1569395223804.html" target="_blank" rel="nofollow noopener">Xilinx Software Command-Line Tool</a> (xsct) や同梱される aarch64 と microblaze 向けクロスコンパイラなども利用するため Vitis が必要です。Vivado だけではだめです</p>
<p>インストールの後半、SD カードに展開した Arch Linux ARM システム初期設定のため chroot する作業があります。もちろんターゲットが ARM なので、直接 chroot はできません。今回は QEMU の力を借ります。QEMU は、<a href="https://www.kernel.org/doc/html/latest/admin-guide/binfmt-misc.html" target="_blank" rel="nofollow noopener">binfmt_misc</a> と組み合わせて aarch64 向けの ELF をあたかも作業マシン上で直に実行できるかのようにしておきます。Arch Linux であれば AUR の <a href="https://aur.archlinux.org/packages/binfmt-qemu-static/" target="_blank" rel="nofollow noopener">binfmt-qemu-static</a> と <a href="https://aur.archlinux.org/packages/qemu-user-static/" target="_blank" rel="nofollow noopener">qemu-user-static</a> パッケージが利用できます (<a href="https://wiki.archlinux.org/index.php/QEMU#Chrooting_into_arm/arm64_environment_from_x86_64" target="_blank" rel="nofollow noopener">ArchWiki</a>)。Docker イメージの <a href="https://github.com/multiarch/qemu-user-static" target="_blank" rel="nofollow noopener">multiarch/qemu-user-static</a> を使うのも簡単です。</p>
<p>Arch Linux 環境に chroot する際には arch-install-scripts の <a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/extra/arch-install-scripts/arch-chroot.8.en" target="_blank" rel="nofollow noopener"><code>arch-chroot</code></a> が便利です。Arch Linux では <code>pacman</code> からインストールできます。それ以外のディストリビューションでも、(使えるかは未確認ですが) こんな感じにインストールできます。もちろん <code>arch-chroot</code> を使わない方法もありますが、ここでは取り扱いません。</p>
<pre><code>$ git clone https://github.com/archlinux/arch-install-scripts
$ cd arch-install-scripts
$ make
$ make install PREFIX=~/.local</code></pre>
<h3 id="fpga-デザインの作成">FPGA デザインの作成</h3>
<p>まずは Vivado で FPGA のデザインを作成します。とりあえず動かすものなら、IP Integrator で Zynq UltraScale+ MPSoC ブロックを配置するだけでよいと思います。</p>
<p>Ultra96 に載ってる Bluetooth を使いたい場合には少し設定が必要です。<a href="https://github.com/Avnet/Ultra96-PYNQ" target="_blank" rel="nofollow noopener">Avnet/Ultra96-PYNQ</a> リポジトリなどの情報によれば、まず PS の設定から UART 0 の MODEM にチェックを入れて</p>
<p><img src="/entry/2020/11/29/archlinux-arm-on-zu/psconfig.png" /></p>
<p>そのあと PS のブロックから生えた <code>emio_uart0_ctsn</code>, <code>emio_uart0_rtsn</code> を適当な名前のポートで外に出します。</p>
<p><img src="/entry/2020/11/29/archlinux-arm-on-zu/ps.png" /></p>
<p>あとはこんな感じの <code>.xdc</code> ファイルを追加して外に出したポートにピンを割り当てればよいそうです。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb2-1"><a href="/entry/2020/11/29/archlinux-arm-on-zu/#cb2-1" aria-hidden="true" tabindex="-1"></a>set_property<span class="ot"> -dict</span> <span class="kw">{</span> PACKAGE_PIN B7   IOSTANDARD LVCMOS18 <span class="kw">}</span> <span class="kw">[</span>get_ports <span class="kw">{</span> BT_ctsn <span class="kw">}]</span>; </span>
<span id="cb2-2"><a href="/entry/2020/11/29/archlinux-arm-on-zu/#cb2-2" aria-hidden="true" tabindex="-1"></a>set_property<span class="ot"> -dict</span> <span class="kw">{</span> PACKAGE_PIN B5   IOSTANDARD LVCMOS18 <span class="kw">}</span> <span class="kw">[</span>get_ports <span class="kw">{</span> BT_rtsn <span class="kw">}]</span>;</span></code></pre></div>
<p>作成したデザインの Bitstream 生成まで済ませたら <code>.xsa</code> ファイルを出力します。TCL Console から次のコマンドを実行するのが簡単です。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode tcl"><code class="sourceCode tcl"><span id="cb3-1"><a href="/entry/2020/11/29/archlinux-arm-on-zu/#cb3-1" aria-hidden="true" tabindex="-1"></a>write_hw_platform<span class="ot"> -fixed -include_bit</span> <span class="ot">system</span>.xsa</span></code></pre></div>
<h3 id="sd-カードへのインストール">SD カードへのインストール</h3>
<p>時間のかかる Arch Linux ARM の tarball のダウンロードから始めるのがおすすめです。Arch Linux ARM は、特定のプラットフォーム向けのもののほか汎用の (Generic) tarball が提供されており、今回はその aarch64 版を使います。<a href="https://archlinuxarm.org/platforms/armv8/generic" target="_blank" rel="nofollow noopener">ここ</a> から <code>ArchLinuxARM-aarch64-latest.tar.gz</code> をダウンロードしておきます。</p>
<p>SD カードには少なくとも2つのパーティションを作ります。1つが後ほど作成する <code>BOOT.BIN</code> やカーネルを置くもの、残りが Arch Linux ARM の rootfs を展開するものです。</p>
<p>パーティションテーブルの操作には <code>fdisk</code> を使うことにします。第1引数に接続した SD カードに対応するデバイス (ここでは <code>/dev/sdX</code>) を渡して起動し</p>
<pre><code>$ sudo fdisk /dev/sdX</code></pre>
<p>まずは <code>o</code> コマンドで新しく空のパーティションテーブルを作成します。</p>
<pre><code>Command (m for help): o
Created a new DOS disklabel with disk identifier 0xad9770e8.</code></pre>
<p><code>n</code> コマンドで1つ目のパーティションを作成します。サイズは 100 ~ 200 MB 程度あれば十分だと思います。作成したパーティションは、<code>t</code> コマンドでタイプを W95 FAT16 (LBA) <code>0x0e</code> または W95 FAT32 (LBA) <code>0x0c</code> に変更しておきます。</p>
<pre><code>Command (m for help): n
Partition type
p   primary (0 primary, 0 extended, 4 free)
e   extended (container for logical partitions)
Select (default p): p
Partition number (1-4, default 1): 1
First sector (2048-124975103, default 2048):
Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-124975103, default 124975103): +200M

Created a new partition 1 of type &#39;Linux&#39; and of size 200 MiB.

Command (m for help): t
Selected partition 1
Hex code or alias (type L to list all): e
Changed type of partition &#39;Linux&#39; to &#39;W95 FAT16 (LBA)&#39;.</code></pre>
<p>再度 <code>n</code> コマンドを使い、rootfs 用のパーティションを作っていきます。今回は残った領域全体を1つのパーティションにしました。</p>
<pre><code>Command (m for help): n
Partition type
p   primary (1 primary, 0 extended, 3 free)
e   extended (container for logical partitions)
Select (default p): p
Partition number (2-4, default 2):
First sector (411648-124975103, default 411648):
Last sector, +/-sectors or +/-size{K,M,G,T,P} (411648-124975103, default 124975103):

Created a new partition 2 of type &#39;Linux&#39; and of size 59.4 GiB.</code></pre>
<p>最後に <code>w</code> コマンドでパーティションテーブルを反映させれば完了です。</p>
<pre><code>Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.</code></pre>
<p>パーティションを作り終わったら、1つ目のパーティションを FAT16 (または FAT32) <a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>で、残りを適当なファイルシステム<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> (下の例は EXT4) でフォーマットします。</p>
<pre><code>$ sudo mkfs.vfat /dev/sdX1
$ sudo mkfs.ext4 /dev/sdX2</code></pre>
<p>フォーマットしたパーティションは、適当なディレクトリ (<code>/mnt</code> など) にマウントし、そこにダウンロードした <code>ArchLinuxARM-aarch64-latest.tar.gz</code> を展開します。</p>
<pre><code>$ sudo mount /dev/sdX2 /mnt
$ sudo mkdir -p /mnt/boot
$ sudo mount /dev/sdX1 /mnt/boot

$ sudo bsdtar -xpf ArchLinuxARM-aarch64-latest.tar.gz -C /mnt
$ sync</code></pre>
<h3 id="展開した-arch-linux-arm-環境の初期設定">展開した Arch Linux ARM 環境の初期設定</h3>
<p>SD カードに展開した Arch Linux ARM 環境は、そのままでは Ultra96 で動かすのに微妙です。例えば WiFi 関連パッケージが入っていないので、そのまま起動させても必要なパッケージを追加したりするのが難しかったりします。展開した環境に chroot し、パッケージの削除・更新・追加などをして実機で起動させたあと困らない状態にしておきます。</p>
<p>前述したとおり、chroot には <code>arch-chroot</code> コマンドを使います。<code>/dev</code> や <code>/sys</code> のマウント・アンマウントや、<code>/etc/resolv.conf</code> への symlink を張ってくれる便利なヤツです。</p>
<pre><code>$ sudo arch-chroot /mnt /bin/bash</code></pre>
<p>chroot したら、特に意味はないですが <code>lscpu</code> みたいなコマンドを実行してみるのがおすすめです。不思議な気持ちになれます。</p>
<pre><code># lscpu
Architecture:                    aarch64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   48 bits physical, 48 bits virtual
CPU(s):                          12
On-line CPU(s) list:             0-11
Thread(s) per core:              2
Core(s) per socket:              6
Socket(s):                       1
NUMA node(s):                    1
Vendor ID:                       AuthenticAMD
CPU family:                      23
Model:                           96
Model name:                      AMD Ryzen 5 PRO 4650U with Radeon Graphics
(...)</code></pre>
<p>Arch Linnux ARM 公式の手順通りに、まずは pacman keyring を初期化します。</p>
<pre><code># packan-key --init
# packan-key --populate archlinuxarm</code></pre>
<p>続いて <code>/etc/pacman.conf</code> を編集しパッケージリポジトリを追加します。ここで指定している <code>zynqmp-arch.myon.info</code> は、前述した GitHub リポジトリの GitHub Pages を使ってホストしているもので、Zynq UltraScale+ MPSoC 向けのカーネルや Ultra96-V2 の WiFi ドライバなどのパッケージを配布しています。このあたりの詳細については後ほど紹介します。</p>
<pre><code># cat &gt;&gt; /etc/pacman.conf &lt;&lt;EOS

[zynqmp-arch]
SigLevel = Never
Server = https://zynqmp-arch.myon.info/\$arch
EOS</code></pre>
<p>Arch Linux ARM の tarball は、この記事執筆時点での最終更新日が 2020/08/09 とちょっと古めなのでパッケージを更新しておきたいところです。ただその前にまず、今後使わなさそうなパッケージをアンインストールしておきます。特にカーネル (<code>linux-aarch64</code>) は、更新時の initramfs の再生成が結構時間がかかってつらいので消しておくとよいです。<code>pacman</code> に渡すオプションは、<code>dhcpcd</code> などはそれらが依存するパッケージも消すために <code>-Rncs</code> で、<code>linux-aarch64</code> はパッケージ単体を消すために <code>-Rnd</code> とするとよさそうです。</p>
<pre><code># pacman -Rncs dhcpcd net-tools netctl
# pacman -Rnd linux-aarch64</code></pre>
<p>そうしたら、システムのパッケージを更新したり</p>
<pre><code># pacman -Syu</code></pre>
<p>WiFi 接続に使う <code>iwd</code> や、<code>zynqmp-arch</code> リポジトリのカーネルや WiFi ドライバなど必要なパッケージをインストールします。</p>
<pre><code># pacman -S iwd
# pacman -S linux-zynqmp
# pacman -S wilc3000-ultra96v2 wilc-firmware</code></pre>
<p>いろいろパッケージのインストールが済んだら、必要なくなったパッケージのアンインストールもしておくとよいでしょう。</p>
<pre><code># pacman -Rncs $(pacman -Qdtq)</code></pre>
<p>ユーザアカウントや <code>/etc/fstab</code> の設定<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>をして完了です。<code>exit</code> で chroot 環境を抜けます。</p>
<pre><code># passwd
# passwd alarm

# cat &gt;&gt; /etc/fstab &lt;&lt;EOS
/dev/mmcblk0p2 /     ext4 defaults 0 1
/dev/mmcblk0p1 /boot vfat defaults 0 2
EOS

# exit</code></pre>
<h3 id="ブートローダファームウェアのビルド">ブートローダ・ファームウェアのビルド</h3>
<p>最後に、First Stage Boot Loader (FSBL) や U-Boot といったブートローダと、ARM Trusted Firmware や PMU のファームウェアの準備、およびそれらをまとめたブートイメージ <code>BOOT.BIN</code> を作ります。これらの手順は、<a href="https://xilinx-wiki.atlassian.net/wiki/spaces/A/pages/460653138/Xilinx+Open+Source+Linux" target="_blank" rel="nofollow noopener">Xilinx Wiki のこのあたり</a> にまとまっているので、あわせて確認するとよいでしょう。</p>
<p>FSBL と PMU Firmware のソースコードは、Xilinx Software Command-Line Tool を使って出力できます。まず、Vivado で出力した <code>.xsa</code> ファイルを、新たに作成したディレクトリにコピーしておきます。これは、このあと <code>xsct</code> で呼び出す <a href="https://www.xilinx.com/html_docs/xilinx2020_1/vitis_doc/dxk1575554094185.html" target="_blank" rel="nofollow noopener"><code>hsi::open_hw_design</code></a> コマンドが、<code>.xsa</code> ファイルあるディレクトリにその中身<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>を展開してくるためです。</p>
<pre><code>$ mkdir xsct &amp;&amp; cd $_
$ cp /path/to/system.xsa .</code></pre>
<p><code>xsct</code> コマンドを実行し、そのインタプリタで次のコマンドを実行します。単にソースコードを出力させるだけならもっと簡単にできるのですが、メッセージの出力を UART 1 に変更するためこうなっています。これらコマンドを実行すると、最初に作成したディレクトリの <code>fsbl</code>, <code>pmufw</code> にそれぞれのソースコードが出力されます。</p>
<pre><code>$ xsct

xsct% set hw_design [hsi open_hw_design system.xsa]

xsct% set sw_design [hsi create_sw_design fsbl -proc psu_cortexa53_0 -os standalone]
xsct% hsi set_property CONFIG.stdin  psu_uart_1 [hsi get_os]
xsct% hsi set_property CONFIG.stdout psu_uart_1 [hsi get_os]
xsct% hsi add_library xilffs
xsct% hsi add_library xilpm
xsct% hsi add_library xilsecure
xsct% hsi generate_app -hw $hw_design -sw $sw_design -app zynqmp_fsbl -dir fsbl
xsct% hsi close_sw_design $sw_design

xsct% set sw_design [hsi create_sw_design pmufw -proc psu_pmu_0 -os standalone]
xsct% hsi set_property CONFIG.stdin  psu_uart_1 [hsi get_os]
xsct% hsi set_property CONFIG.stdout psu_uart_1 [hsi get_os]
xsct% hsi add_library xilfpga
xsct% hsi add_library xilsecure
xsct% hsi add_library xilskey
xsct% hsi generate_app -hw $hw_design -sw $sw_design -app zynqmp_pmufw -dir pmufw
xsct% hsi close_sw_design $sw_design

xsct% exit</code></pre>
<p>実行するコマンドは TCL のスクリプトにしておき、それを <code>xsct</code> コマンドに渡してもいいかもしれません。</p>
<pre><code>$ xsct script.tcl</code></pre>
<p>Ultra96 では、PMU Firmware のデフォルトで無効になっているいくつかのオプションを指定してやると便利です。基板上の電源ボタンでシャットダウンが効くように、<code>Makefile</code> の <code>CFLAGS</code> に <code>-DENABLE_MOD_ULTRA96</code> および <code>-DULTRA96_VERSION=&lt;Ultra96 のバージョン&gt;</code> を追記します。</p>
<pre><code>$ sed -i &#39;s/^\(CFLAGS :=.*$\)/\1 -DENABLE_MOD_ULTRA96 -DULTRA96_VERSION=2/&#39; pmufw/Makefile</code></pre>
<p>また、電源ボタンやコマンドなどからのシャットダウンで完全に電源を落とすために、<code>pmufw/xpfw_config.h</code> を編集し <code>PMU_MIO_INPUT_PIN_VAL</code>, <code>BOARD_SHUTDOWN_PIN_VAL</code>, <code>BOARD_SHUTDOWN_PIN_STATE_VAL</code> を <code>1</code> に変更します。</p>
<pre><code>$ sed -i &#39;s/^\(#define\s\+PMU_MIO_INPUT_PIN_VAL\).*/\1 (1U)/;
          s/^\(#define\s\+BOARD_SHUTDOWN_PIN_VAL\).*/\1 (1U)/;
          s/^\(#define\s\+BOARD_SHUTDOWN_PIN_STATE_VAL\).*/\1 (1U)/&#39; pmufw/xpfw_config.h</code></pre>
<p>ソースコードの準備ができたらビルドします。ビルドに使われる aarch64 や microblaze のクロスコンパイラは、何もしなければ Vitis に入っているものが使われます。ビルドが終わると、それぞれのディレクトリに <code>executable.elf</code> が出力されます。ちなみにここで実行している <code>make</code> にビルドのジョブ数の指定オプション (<code>-jN</code>) を付けてはいけません。よくある依存関係が微妙な <code>Makefile</code> のようでビルドに失敗することがあります。</p>
<pre><code>$ make -C fsbl
$ make -C pmufw</code></pre>
<p>続いて Arm Trusted Firmware と U-Boot をビルドします。これらはソースコードを落としてきてビルドするだけなので簡単です。<code>make</code> 時にクロスコンパイラの実行ファイル名のプレフィックスを <code>CROSS_COMPILE</code> に指定すること、Arm Trusted Firmware の出力を UART 1 にするため <code>ZYNQMP_CONSOLE=cadence1</code> を付けること、U-Boot ビルド時に Arm Trusted Firmware ビルド時の生成物である <code>bl31.bin</code> のファイルパスが必要なことあたりがポイントです。U-Boot ビルド時 <code>DEVICE_TREE</code> に指定している <code>avnet-ultra96-rev1</code> は、厳密には初代 Ultra96 のものです。ただ U-Boot ではあまり関係ないのと、Linux ブート時に渡す Device Tree はまた別のものを指定できるので特に問題ないです。</p>
<pre><code>$ mkdir arm-trusted-firmware &amp;&amp; cd $_
$ curl -L https://github.com/Xilinx/arm-trusted-firmware/archive/xilinx-v2020.1.tar.gz | \
    tar xz --strip-components=1 -C .

$ CROSS_COMPILE=aarch64-linux-gnu- ARCH=aarch64 \
    make -j12 PLAT=zynqmp RESET_TO_BL31=1 ZYNQMP_CONSOLE=cadence1

$ cd ..

$ mkdir u-boot-xlnx &amp;&amp; cd $_
$ curl -L https://github.com/Xilinx/u-boot-xlnx/archive/xilinx-v2020.1.tar.gz | \
    tar xz --strip-components=1 -C .

$ CROSS_COMPILE=aarch64-linux-gnu- ARCH=aarch64 make xilinx_zynqmp_virt_defconfig
$ CROSS_COMPILE=aarch64-linux-gnu- ARCH=aarch64 \
    DEVICE_TREE=&quot;avnet-ultra96-rev1&quot; \
    BL31=$PWD/../arm-trusted-firmware/build/zynqmp/release/bl31.bin \
    make -j12 u-boot.elf

$ cd ..</code></pre>
<p>ここまででビルドしたもの、および Bitstream を適当なディレクトにコピーし、<code>bootgen</code> コマンドを使って <code>BOOT.BIN</code> ファイルを出力します。Bitstream には、<code>xsct</code> が展開したものを使うのが楽そうです。作成した <code>BOOT.BIN</code> は、SD カードの第1パーティションにコピーします。</p>
<pre><code>$ mkdir boot &amp;&amp; cd $_
$ cp ../xsct/fsbl/executable.elf fsbl.elf
$ cp ../xsct/pmufw/executable.elf pmufw.elf
$ cp ../xsct/&lt;bitstream_name&gt;.bit bitstream.bit
$ cp ../arm-trusted-firmware/build/zynqmp/release/bl31/bl31.elf .
$ cp ../u-boot-xlnx/u-boot.elf .

$ cat &gt; boot.bif &lt;&lt;EOS
the_ROM_image:
{
  [destination_cpu=a53-0, bootloader]                       fsbl.elf
  [destination_cpu=pmu]                                     pmufw.elf
  [destination_device=pl]                                   bitstream.bit
  [destination_cpu=a53-0, exception_level=el-3, trustzone]  bl31.elf
  [destination_cpu=a53-0, exception_level=el-2]             u-boot.elf
}
EOS

$ bootgen -arch zynqmp -image boot.bif -w -o BOOT.BIN
$ sudo cp BOOT.BIN /mnt/boot/</code></pre>
<p>U-Boot は、ブートデバイスに <code>boot.scr</code> という名前で保存されたスクリプトを実行してくれるみたいです。これを利用してカーネルや initramfs、Device Tree を読み込ませることにします。まず <code>boot.cmd</code> などの適当な名前でファイルを作成し、こんな感じに記述します<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>。<code>bootargs</code> にはカーネルの起動オプションを、<code>fdtfile</code> には Device Tree Blob のファイル名を指定します<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>。Device Tree Blob のファイルは、<code>linux-zynqmp</code> パッケージが第1パーティションにインストールしたものが使えます。Ultra96-V2 向けに編集したものも <code>avnet-ultra96-v2-rev1.dtb</code> という名前で追加してあります。</p>
<pre><code>setenv bootargs earlycon clk_ignore_unused root=/dev/mmcblk0p2 rw rootwait

setenv fdtfile xilinx/avnet-ultra96-v2-rev1.dtb

if load ${devtype} ${devnum}:${distro_bootpart} 0x00200000 /Image; then
  if load ${devtype} ${devnum}:${distro_bootpart} 0x00100000 /dtbs/${fdtfile}; then
    if load ${devtype} ${devnum}:${distro_bootpart} 0x04000000 /initramfs-linux-zynqmp.img; then
      booti 0x00200000 0x04000000:${filesize} 0x00100000;
    fi;
  fi;
fi</code></pre>
<p>U-Boot をビルドしたディレクトリに <code>mkimage</code> というツールが入っているはずです。これを使って、作成したスクリプトから <code>boot.scr</code> を出力します。出力した <code>boot.scr</code> も SD カードの第1パーティションにコピーすれば準備完了です。</p>
<pre><code>$ /path/to/u-boot-xlnx/tools/mkimage -c none -A arm64 -T script -d boot.cmd boot.scr
$ sudo cp boot.scr /mnt/boot/</code></pre>
<h3 id="起動">起動!</h3>
<p>SD カードをアンマウントしてから取り外し、Ultra96 に入れます。</p>
<pre><code>$ sudo umount /mnt{/boot,}</code></pre>
<p>Ultra96 の電源を入れると、シリアルコンソールからまず FSBL, PMU Firmware, Arm Trusted Firmware, U-Boot とメッセージが表示されます。</p>
<pre><code>Xilinx Zynq MP First Stage Boot Loader
Release 2020.1   Nov  7 2020  -  11:51:03
PMU Firmware 2020.1	Nov  7 2020   11:51:27
PMU_ROM Version: xpbr-v8.1.0-0
NOTICE:  ATF running on XCZU3EG/silicon v4/RTL5.1 at 0xfffea000
NOTICE:  BL31: v2.2(release):
NOTICE:  BL31: Built : 11:51:33, Nov  7 2020


U-Boot 2020.01 (Nov 07 2020 - 11:51:38 +0000)

Model: Avnet Ultra96 Rev1
Board: Xilinx ZynqMP
DRAM:  2 GiB
PMUFW:	v1.1
EL Level:	EL2
Chip ID:	zu3eg
(...)</code></pre>
<p>その後 <code>boot.scr</code> が読み込まれ、カーネルの実行が始まります。最後に Arch Linux のログインプロンプトが出たら成功です。</p>
<pre><code>switch to partitions #0, OK
mmc0 is current device
Scanning mmc 0:1...
Found U-Boot script /boot.scr
524 bytes read in 17 ms (29.3 KiB/s)
## Executing script at 20000000
22747648 bytes read in 1820 ms (11.9 MiB/s)
40479 bytes read in 26 ms (1.5 MiB/s)
8193054 bytes read in 668 ms (11.7 MiB/s)
## Flattened Device Tree blob at 00100000
   Booting using the fdt blob at 0x100000
   Loading Ramdisk to 7882f000, end 78fff41e ... OK
   Loading Device Tree to 000000000fff3000, end 000000000ffffe1e ... OK

Starting kernel ...

[    0.000000] Booting Linux on physical CPU 0x0000000000 [0x410fd034]
[    0.000000] Linux version 5.4.0-1-ARCH (alarm@buildenv) (gcc version 10.2.0 (GCC)) #1 SMP Mon Nov 9 07:02:37 UTC 2020
[    0.000000] Machine model: Avnet Ultra96-V2 Rev1
[    0.000000] earlycon: cdns0 at MMIO 0x00000000ff010000 (options &#39;115200n8&#39;)
[    0.000000] printk: bootconsole [cdns0] enabled

(...)

Arch Linux 5.4.0-1-ARCH (ttyPS0)

alarm login:</code></pre>
<h2 id="tosainuzynqmp-arch-リポジトリ">Tosainu/zynqmp-arch リポジトリ</h2>
<p>GitHub リポジトリ <a href="https://github.com/Tosainu/zynqmp-arch" target="_blank" rel="nofollow noopener">Tosainu/zynqmp-arch</a> には、インストール方法で少し紹介したカーネルパッケージ <code>linux-zynqmp</code> や WiFi ドライバ <code>wilc3000-ultra96v2</code> などの <code>PKGBUILD</code> ファイルを置いています。また、これらのビルド済みパッケージを GitHub Pages を利用してホストしていて、<code>/etc/pacman.conf</code> などを設定すればこれらパッケージを<code>pacman</code> 経由でインストールできます。</p>
<p>Arch Linux ARM に限らず、公式でのサポートがない何かしらの Linux ディストリビューションを、とりあえずカーネルは動く環境に載せるだけなら、rootfs にクロスコンパイルしたカーネルなどを放り込むのが1番早いと思います。実際、最初はこの方法で環境を作りいろいろ検証していました。それでもわざわざパッケージ化しているのは、自分が長く安定した Arch Linux 環境を作りたかったからです。一般ユーザで書き込めない領域を雑に弄るのは、パッケージマネージャでの更新時に壊れるおそらく1番の原因です。変に壊れる環境にしたくないので、パッケージ化は絶対やりたかったです。</p>
<p>パッケージ化したうえにビルド済みパッケージの配布環境まで整備したのは、この記事や GitHub リポジトリを見て試そうする方がいるのかはわかりませんが、せっかくインストール方法を紹介するのならできる限り敷居の低い方法にしたいと考えていたためです。そうしたとき、<code>PKGBUILD</code> を公開するだけなのは微妙です。Arch Linux パッケージのビルドにはクロスコンパイラなどを使うのがほぼ想定されていないため、実機または QEMU などによるエミュレーションなどですでに Arch Linux ARM が動いている環境が必要になります。インストール方法の紹介で構築済みの環境を要求するのはアレですし、エミュレーション環境を用意しろというのも手間のかかる上に時間がかかるので微妙です。</p>
<p>ビルド済みパッケージを配布するうえで悩んだのが、それをどこでビルドするかです。自分は出どころ・ビルドのプロセスが明確でないバイナリを拾ってきて実行するのにうーむとなるタイプなので、せめてビルドからデプロイまでをオープンな場所でやらせたい思いがありました。ただ、前述したとおり Arch Linux ARM のパッケージのビルドには Arch Linux ARM が必要です。いろいろ悩みましたが、とりあえず GitHub Actions 上で QEMU + binfmt_misc の設定をし、そこで Arch Linux ARM な Docker イメージを作成したり、作成したイメージを使ったコンテナ上でパッケージをビルドしています。もちろんこれには結構時間がかかっていて、カーネルのビルドだけで4時間ぐらいかかります。Ultra96 実機でカーネルをビルドさせたら1時間半くらいだったので、それよりも遅いことになります。頻繁にビルドさせるつもりはないので困ってはいませんが、何かしらの改善はしたいなと思っています。Travis CI や AWS の Graviton Processor が載ってるインスタンスなど ARM な環境を試すだとか、Arch Linux パッケージのクロスコンパイル方法を確立するだとか、部分的に aarch64 だったり x86_64 だったりする特殊な環境を作ってみるだとか…</p>
<h2 id="おわり">おわり</h2>
<p>Ultra96-V2 をはじめとする Zynq UltraScale+ MPSoC が載ってるボードは、単純に ARM なシングルボードコンピュータとして見てもおもしろいですし、そこから Zynq を活かせたらもっと楽しくなりそうだなと思っています。今回の Arch Linux ARM の件を通して ZU+ で動かすソフトウェアの幅がまた広がったので、今度は特に <a href="https://xilinx-wiki.atlassian.net/wiki/spaces/A/pages/18841847/Solution+ZynqMP+PL+Programming" target="_blank" rel="nofollow noopener">Linux からの PL のリコンフィグレーション</a> と組み合わせて何かやってみたいですね。</p>
<section class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>つい最近 <a href="https://www.xilinx.com/support/download/index.html/content/xilinx/en/downloadNav/vivado-design-tools/2020-2.html" target="_blank" rel="nofollow noopener">v2020.2</a> が出たっぽいですね。自分はまだ確認できていませんが、“- Petalinux now a part of Xilinx Unified Installer” が気になります。あの微妙なインストーラが改善されてたりするのかな…<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Vitis はインストールサイズが 100GB 程度もあって<a href="/entry/2018/09/15/install-xilinx-tools-into-docker-container/">以前紹介した</a> Docker 環境だと扱いづらくなる<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p><a href="https://www.xilinx.com/support/documentation/user_guides/ug1085-zynq-ultrascale-trm.pdf" target="_blank" rel="nofollow noopener">Technical Reference Manual (ug1085)</a> の “Chapter 11: Boot and Configuration” によると FAT16 / FAT32 ともに対応しているらしい。いろいろ試した感じ、電源投入後に基板上の DONE_LED (D1) 点灯までの時間が FAT16 のほうが速い気がするので FAT16 で運用してみてる<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>自分は F2FS を試しています<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Ultra96 にさした micro SD カードは特別なことをしなければ <code>/dev/mmcblk0</code> になると思うのでこれで指定しています。たくさん SATA や NVMe などのストレージを載せるマシンだと、ポートを繋ぎ変えたときなどでも目的のパーティションを確実にマウントさせるため UUID やラベルを使ったりします<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6" role="doc-endnote"><p><code>.xsa</code> ファイルは Zip 形式で圧縮されたファイルっぽい<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7" role="doc-endnote"><p>カーネル、<code>.dtb</code>、initramfs のアドレスは PetaLinux Tools で Linux 環境を作ったとき出力された <code>boot.scr</code> を参考にしています<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8" role="doc-endnote"><p><a href="https://github.com/Xilinx/u-boot-xlnx" target="_blank" rel="nofollow noopener">Xilinx/u-boot-xlnx</a> には、<code>.dtb</code> の <code>compatible</code> から <code>fdtfile</code> の初期値を決める<a href="https://github.com/Xilinx/u-boot-xlnx/blob/xilinx-v2020.2/board/xilinx/zynqmp/zynqmp.c#L462-L497" target="_blank" rel="nofollow noopener">こんな処理</a>が実装されています。この関数では <code>&quot;xlnx,zynqmp-zcu104-revA&quot;</code> といった文字列から <code>&#39;,&#39;</code> よりあとを取り出し <code>&quot;xilinx/zynqmp-zcu104-revA.dtb&quot;</code> という文字列を作って <code>fdtfile</code> に指定しているのですが、<code>compatible</code> に <code>&quot;avnet,ultra96-rev1&quot;</code>、実際のファイル名が <code>avnet-ultra96-rev1.dtb</code> となる Ultra96 では適切なパスになってくれません。面倒だったので <code>boot.scr</code> から指定し直していますが、公式に何かしら報告したほうがいい事案な気もしています<a href="/entry/2020/11/29/archlinux-arm-on-zu/#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div><aside class="comments"><div id="disqus_thread"></div><script>(function() { var d = document, s = d.createElement('script');s.src = 'https://tosainu.disqus.com/embed.js';s.setAttribute('data-timestamp', +new Date());(d.head || d.body).appendChild(s); })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener">comments powered by Disqus.</a></noscript></aside></div></article></main><footer class="site-footer"><div class="footer-widgets"><div class="container"><div class="col"><section class="about-me"><h4><svg class="svg-inline--fa fa-user fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="user" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0S96 57.3 96 128s57.3 128 128 128zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512H418.3c16.4 0 29.7-13.3 29.7-29.7C448 383.8 368.2 304 269.7 304H178.3z" fill="currentColor"></path></svg> About Me</h4><div class="about"><div class="avatar"><img src="/images/icon/cocoa.svg" class="icon" alt="avatar"></div><div class="info"><div class="name"><a href="https://myon.info" target="_blank" rel="nofollow noopener">Tosainu</a></div><div class="info">❤ Arch Linux, ごちうさ</div></div></div></section><section class="recent-posts"><h4><svg class="svg-inline--fa fa-file fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 384 512" data-icon="file" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z" fill="currentColor"></path></svg> Recent Posts</h4><ul><li><a href="/entry/2022/09/19/earthly-zynqmp/">とにかく複雑な Zynq のソフトウェアを Earthly でビルドする</a></li><li><a href="/entry/2020/11/29/archlinux-arm-on-zu/">Ultra96 で Arch Linux ARM を動かす</a></li><li><a href="/entry/2020/09/01/thinkpad-x13/">ThinkPad X13 を買いました</a></li><li><a href="/entry/2020/07/05/bus-blaster/">Bus Blaster で Raspberry Pi Model B を JTAG デバッグしてみる</a></li><li><a href="/entry/2019/10/21/make-own-language-and-compiler/">Brainf**k からはじめる自作コンパイラ</a></li></ul></section></div><section class="tag-cloud"><h4><svg class="svg-inline--fa fa-tags fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="tags" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M345 39.1L472.8 168.4c52.4 53 52.4 138.2 0 191.2L360.8 472.9c-9.3 9.4-24.5 9.5-33.9 .2s-9.5-24.5-.2-33.9L438.6 325.9c33.9-34.3 33.9-89.4 0-123.7L310.9 72.9c-9.3-9.4-9.2-24.6 .2-33.9s24.6-9.2 33.9 .2zM0 229.5V80C0 53.5 21.5 32 48 32H197.5c17 0 33.3 6.7 45.3 18.7l168 168c25 25 25 65.5 0 90.5L277.3 442.7c-25 25-65.5 25-90.5 0l-168-168C6.7 262.7 0 246.5 0 229.5zM144 144c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32z" fill="currentColor"></path></svg> Tags</h4><ul class="tag-list"><li><a href="/entry/tags/android/"><span>Android</span></a></li><li><a href="/entry/tags/arch-linux/"><span>Arch Linux</span></a></li><li><a href="/entry/tags/arduino/"><span>Arduino</span></a></li><li><a href="/entry/tags/c/"><span>C++</span></a></li><li><a href="/entry/tags/ctf/"><span>CTF</span></a></li><li><a href="/entry/tags/diy-pc/"><span>DIY PC</span></a></li><li><a href="/entry/tags/docker/"><span>Docker</span></a></li><li><a href="/entry/tags/fpga/"><span>FPGA</span></a></li><li><a href="/entry/tags/game/"><span>Game</span></a></li><li><a href="/entry/tags/gochiusa/"><span>Gochiusa</span></a></li><li><a href="/entry/tags/hakyll/"><span>Hakyll</span></a></li><li><a href="/entry/tags/haskell/"><span>Haskell</span></a></li><li><a href="/entry/tags/linux/"><span>Linux</span></a></li><li><a href="/entry/tags/machine-learning/"><span>Machine learning</span></a></li><li><a href="/entry/tags/network/"><span>Network</span></a></li><li><a href="/entry/tags/raspberry-pi/"><span>Raspberry Pi</span></a></li><li><a href="/entry/tags/rust/"><span>Rust</span></a></li><li><a href="/entry/tags/slack/"><span>Slack</span></a></li><li><a href="/entry/tags/thinkpad-x13/"><span>ThinkPad X13</span></a></li><li><a href="/entry/tags/vaio-z2/"><span>VAIO Z2</span></a></li><li><a href="/entry/tags/vim/"><span>Vim</span></a></li><li><a href="/entry/tags/walkmanz/"><span>WalkmanZ</span></a></li><li><a href="/entry/tags/website/"><span>Website</span></a></li><li><a href="/entry/tags/xperia-nx/"><span>Xperia NX</span></a></li><li><a href="/entry/tags/xperia-arc/"><span>Xperia arc</span></a></li><li><a href="/entry/tags/xperia2011/"><span>Xperia2011</span></a></li><li><a href="/entry/tags/seccamp/"><span>seccamp</span></a></li></ul></section><section class="archives"><h4><svg class="svg-inline--fa fa-box-archive fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 512 512" data-icon="box-archive" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M32 32H480c17.7 0 32 14.3 32 32V96c0 17.7-14.3 32-32 32H32C14.3 128 0 113.7 0 96V64C0 46.3 14.3 32 32 32zm0 128H480V416c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V160zm128 80c0 8.8 7.2 16 16 16H336c8.8 0 16-7.2 16-16s-7.2-16-16-16H176c-8.8 0-16 7.2-16 16z" fill="currentColor"></path></svg> Archives</h4><ul class="archive-tree"><li><input class="tree-toggle" type="checkbox" id="tree-label-2022"><label class="tree-toggle-button" for="tree-label-2022"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2022/">2022 (1)</a></label><ul class="tree-child"><li><a href="/entry/2022/09/">2022/09 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2020" checked><label class="tree-toggle-button" for="tree-label-2020"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2020/">2020 (3)</a></label><ul class="tree-child"><li><a href="/entry/2020/11/">2020/11 (1)</a></li><li><a href="/entry/2020/09/">2020/09 (1)</a></li><li><a href="/entry/2020/07/">2020/07 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2019"><label class="tree-toggle-button" for="tree-label-2019"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2019/">2019 (4)</a></label><ul class="tree-child"><li><a href="/entry/2019/10/">2019/10 (1)</a></li><li><a href="/entry/2019/08/">2019/08 (2)</a></li><li><a href="/entry/2019/05/">2019/05 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2018"><label class="tree-toggle-button" for="tree-label-2018"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2018/">2018 (5)</a></label><ul class="tree-child"><li><a href="/entry/2018/10/">2018/10 (1)</a></li><li><a href="/entry/2018/09/">2018/09 (1)</a></li><li><a href="/entry/2018/08/">2018/08 (1)</a></li><li><a href="/entry/2018/03/">2018/03 (1)</a></li><li><a href="/entry/2018/01/">2018/01 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2017"><label class="tree-toggle-button" for="tree-label-2017"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2017/">2017 (5)</a></label><ul class="tree-child"><li><a href="/entry/2017/09/">2017/09 (1)</a></li><li><a href="/entry/2017/05/">2017/05 (1)</a></li><li><a href="/entry/2017/02/">2017/02 (3)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2016"><label class="tree-toggle-button" for="tree-label-2016"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2016/">2016 (8)</a></label><ul class="tree-child"><li><a href="/entry/2016/08/">2016/08 (2)</a></li><li><a href="/entry/2016/07/">2016/07 (1)</a></li><li><a href="/entry/2016/06/">2016/06 (1)</a></li><li><a href="/entry/2016/05/">2016/05 (1)</a></li><li><a href="/entry/2016/03/">2016/03 (1)</a></li><li><a href="/entry/2016/01/">2016/01 (2)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2015"><label class="tree-toggle-button" for="tree-label-2015"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2015/">2015 (12)</a></label><ul class="tree-child"><li><a href="/entry/2015/12/">2015/12 (1)</a></li><li><a href="/entry/2015/08/">2015/08 (1)</a></li><li><a href="/entry/2015/06/">2015/06 (2)</a></li><li><a href="/entry/2015/05/">2015/05 (2)</a></li><li><a href="/entry/2015/04/">2015/04 (1)</a></li><li><a href="/entry/2015/03/">2015/03 (2)</a></li><li><a href="/entry/2015/02/">2015/02 (1)</a></li><li><a href="/entry/2015/01/">2015/01 (2)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2014"><label class="tree-toggle-button" for="tree-label-2014"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2014/">2014 (62)</a></label><ul class="tree-child"><li><a href="/entry/2014/12/">2014/12 (7)</a></li><li><a href="/entry/2014/11/">2014/11 (4)</a></li><li><a href="/entry/2014/10/">2014/10 (3)</a></li><li><a href="/entry/2014/09/">2014/09 (3)</a></li><li><a href="/entry/2014/08/">2014/08 (5)</a></li><li><a href="/entry/2014/07/">2014/07 (6)</a></li><li><a href="/entry/2014/06/">2014/06 (6)</a></li><li><a href="/entry/2014/05/">2014/05 (4)</a></li><li><a href="/entry/2014/04/">2014/04 (6)</a></li><li><a href="/entry/2014/03/">2014/03 (7)</a></li><li><a href="/entry/2014/02/">2014/02 (5)</a></li><li><a href="/entry/2014/01/">2014/01 (6)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2013"><label class="tree-toggle-button" for="tree-label-2013"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2013/">2013 (116)</a></label><ul class="tree-child"><li><a href="/entry/2013/12/">2013/12 (8)</a></li><li><a href="/entry/2013/11/">2013/11 (6)</a></li><li><a href="/entry/2013/10/">2013/10 (5)</a></li><li><a href="/entry/2013/09/">2013/09 (5)</a></li><li><a href="/entry/2013/08/">2013/08 (4)</a></li><li><a href="/entry/2013/07/">2013/07 (3)</a></li><li><a href="/entry/2013/06/">2013/06 (12)</a></li><li><a href="/entry/2013/05/">2013/05 (16)</a></li><li><a href="/entry/2013/04/">2013/04 (16)</a></li><li><a href="/entry/2013/03/">2013/03 (27)</a></li><li><a href="/entry/2013/02/">2013/02 (7)</a></li><li><a href="/entry/2013/01/">2013/01 (7)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2012"><label class="tree-toggle-button" for="tree-label-2012"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2012/">2012 (11)</a></label><ul class="tree-child"><li><a href="/entry/2012/12/">2012/12 (3)</a></li><li><a href="/entry/2012/09/">2012/09 (1)</a></li><li><a href="/entry/2012/07/">2012/07 (4)</a></li><li><a href="/entry/2012/04/">2012/04 (1)</a></li><li><a href="/entry/2012/03/">2012/03 (1)</a></li><li><a href="/entry/2012/01/">2012/01 (1)</a></li></ul></li><li><input class="tree-toggle" type="checkbox" id="tree-label-2011"><label class="tree-toggle-button" for="tree-label-2011"><svg class="svg-inline--fa fa-angle-right fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 320 512" data-icon="angle-right" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg><svg class="svg-inline--fa fa-angle-down fa-fw" focusable="false" aria-hidden="true" role="img" viewBox="0 0 448 512" data-icon="angle-down" data-prefix="fas" xmlns="http://www.w3.org/2000/svg"><path d="M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z" fill="currentColor"></path></svg><a href="/entry/2011/">2011 (12)</a></label><ul class="tree-child"><li><a href="/entry/2011/09/">2011/09 (1)</a></li><li><a href="/entry/2011/06/">2011/06 (1)</a></li><li><a href="/entry/2011/05/">2011/05 (1)</a></li><li><a href="/entry/2011/03/">2011/03 (6)</a></li><li><a href="/entry/2011/02/">2011/02 (1)</a></li><li><a href="/entry/2011/01/">2011/01 (2)</a></li></ul></li></ul></section></div></div><div class="footer-bottom"><div class="container"><div class="copyright">© 2011-2022 Tosainu. Site generated by <a href="https://jaspervdj.be/hakyll/" target="_blank" rel="nofollow noopener">Hakyll</a>.</div></div></div></footer></body></html>
